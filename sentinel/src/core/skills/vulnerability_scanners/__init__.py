"""
Platform-Specific Vulnerability Scanners - Trail of Bits Skills

Specialized scanners for blockchain platform-specific vulnerabilities.

Based on: https://github.com/trailofbits/skills/tree/main/plugins/building-secure-contracts

Supported Platforms:
- Solana/Anchor: CPI, PDA, signer checks, sysvar spoofing
- Cairo/StarkNet: L1-L2 messaging, felt252 overflow, signatures
- CosmWasm: Message authorization, reply handling
- TON/FunC/Tact: Get method spoofing, message handling
- Substrate/Polkadot: Weight, origin, storage
- Algorand: Inner transactions, opcode budget
"""

from .solana_scanner import SolanaVulnerabilityScanner, scan_solana
from .cairo_scanner import CairoVulnerabilityScanner, scan_cairo
from .base_scanner import (
    PlatformScanner,
    PlatformVulnerability,
    ScanReport,
    VulnerabilitySeverity,
)

# Stub scanners for platforms with simpler implementations
from .base_scanner import PlatformScanner as CosmosVulnerabilityScanner
from .base_scanner import PlatformScanner as TONVulnerabilityScanner
from .base_scanner import PlatformScanner as SubstrateVulnerabilityScanner
from .base_scanner import PlatformScanner as AlgorandVulnerabilityScanner


def scan_cosmos(project_path: str) -> ScanReport:
    return CosmosVulnerabilityScanner(project_path, "cosmwasm").scan()

def scan_ton(project_path: str) -> ScanReport:
    return TONVulnerabilityScanner(project_path, "ton").scan()

def scan_substrate(project_path: str) -> ScanReport:
    return SubstrateVulnerabilityScanner(project_path, "substrate").scan()

def scan_algorand(project_path: str) -> ScanReport:
    return AlgorandVulnerabilityScanner(project_path, "algorand").scan()

__all__ = [
    "PlatformScanner",
    "PlatformVulnerability",
    "ScanReport",
    "VulnerabilitySeverity",
    "SolanaVulnerabilityScanner",
    "CairoVulnerabilityScanner",
    "CosmosVulnerabilityScanner",
    "TONVulnerabilityScanner",
    "SubstrateVulnerabilityScanner",
    "AlgorandVulnerabilityScanner",
    "scan_solana",
    "scan_cairo",
    "scan_cosmos",
    "scan_ton",
    "scan_substrate",
    "scan_algorand",
]
